õ
XC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Controllers\LoginController.cs
	namespace 	
TheRoadWarrior
 
. 
Controllers $
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
LoginController  
:! "
ControllerBase# 1
{ 
readonly !
ReservationsDbContext &
Database' /
;/ 0
public 
LoginController 
( !
ReservationsDbContext 4
db5 7
)7 8
{ 	
Database 
= 
db 
; 
} 	
[ 	
HttpPost	 
] 
public  
LoginResponseWrapper #
Post$ (
() *
LoginRequest* 6
request7 >
)> ?
{ 	 
LoginResponseWrapper  
rsp! $
=% &
new' * 
LoginResponseWrapper+ ?
(? @
)@ A
;A B
{ 
try 
{ 
var 
usr 
= 
Database &
.& '
GetUser' .
(. /
request/ 6
.6 7
Username7 ?
)? @
;@ A
if 
( 
PasswordHasher %
.% &
	checkHash& /
(/ 0
request0 7
.7 8
Password8 @
,@ A
usrB E
.E F
	LoginHashF O
)O P
)P Q
{R S
rsp   
.   
ResponseCode   (
=  ) *
$num  + .
;  . /
rsp!! 
.!! 
Description!! '
=!!( )
$str!!* .
;!!. /
rsp"" 
."" 
ApiKey"" "
=""# $
usr""% (
.""( )
ApiKey"") /
;""/ 0
}## 
}$$ 
catch%% 
{&& 
rsp'' 
.'' 
ResponseCode'' $
=''% &
$num''' *
;''* +
rsp(( 
.(( 
Description(( #
=(($ %
$str((& ?
;((? @
})) 
}** 
return++ 
rsp++ 
;++ 
},, 	
}-- 
}.. ≈
[C:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Controllers\RegisterController.cs
	namespace 	
TheRoadWarrior
 
. 
Controllers $
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
RegisterController #
:$ %
ControllerBase& 4
{ 
readonly !
ReservationsDbContext &
Database' /
;/ 0
public 
RegisterController !
(! "!
ReservationsDbContext" 7
db8 :
): ;
{ 	
Database 
= 
db 
; 
} 	
[ 	
HttpPost	 
] 
public  
LoginResponseWrapper #
Post$ (
(( )
RegisterRequest) 8
request9 @
)@ A
{ 	 
LoginResponseWrapper  
rsp! $
=% &
new' * 
LoginResponseWrapper+ ?
(? @
)@ A
;A B
String 
	loginHash 
= 
PasswordHasher -
.- .
getHash. 5
(5 6
request6 =
.= >
Password> F
+G H
requestI P
.P Q
UsernameQ Y
)Y Z
;Z [
String 
apiKey 
= 
PasswordHasher *
.* +
getHash+ 2
(2 3
request3 :
.: ;
Password; C
)C D
;D E
if 
( 
request 
. 
PasswordCheck $
!=% '
request( /
./ 0
Password0 8
)8 9
{ 
rsp 
. 
ResponseCode  
=! "
$num# &
;& '
rsp   
.   
Description   
=    !
$str  " :
;  : ;
return!! 
rsp!! 
;!! 
}"" 
try## 
{$$ 
Database%% 
.%% 
CreateTravellerUser%% ,
(%%, -
apiKey%%- 3
,%%3 4
	loginHash%%5 >
,%%> ?
request%%@ G
.%%G H
Username%%H P
)%%P Q
;%%Q R
rsp&& 
.&& 
ResponseCode&&  
=&&! "
$num&&# &
;&&& '
rsp'' 
.'' 
ApiKey'' 
='' 
apiKey'' #
;''# $
rsp(( 
.(( 
Description(( 
=((  !
$str((" &
;((& '
})) 
catch** 
{++ 
rsp,, 
.,, 
ResponseCode,,  
=,,! "
$num,,# &
;,,& '
rsp-- 
.-- 
Description-- 
=--  !
$str--" <
;--< =
}.. 
return// 
rsp// 
;// 
}00 	
}22 
}33 õ
XC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Controllers\TripsController.cs
	namespace 	
TheRoadWarrior
 
. 
Controllers $
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
TripsController  
:! "
ControllerBase# 1
{ 
readonly !
ReservationsDbContext &
Database' /
;/ 0
public 
TripsController 
( !
ReservationsDbContext 4
db5 7
)7 8
{ 	
Database 
= 
db 
; 
} 	
[ 	
HttpPost	 
] 
public 
AddTripResponse 
AddTrip  '
(( )
AddTripRequest) 7
rq8 :
): ;
{ 	
AddTripResponse 
rsp 
=  !
new" %
AddTripResponse& 5
(5 6
)6 7
;7 8
try 
{ 
var 
usr 
= 
Database "
." #
GetUserByApiKey# 2
(2 3
rq3 5
.5 6
ApiKey6 <
)< =
;= >
Database 
. 

CreateTrip #
(# $
usr$ '
.' (
Id( *
,* +
rq, .
.. /
TripName/ 7
)7 8
;8 9
rsp 
. 
Description 
=  !
$str" +
;+ ,
rsp 
. 
ResponseCode  
=! "
$num# &
;& '
}   
catch   
{!! 
rsp"" 
."" 
Description"" 
=""  !
$str""" ;
;""; <
rsp## 
.## 
ResponseCode##  
=##! "
$num### &
;##& '
}$$ 
return%% 
rsp%% 
;%% 
}&& 	
}'' 
}(( Óú
iC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Data\Migrations\20210329073407_InitialCreate.cs
	namespace 	
TheRoadWarrior
 
. 
Data 
. 

Migrations (
{ 
public 

partial 
class 
InitialCreate &
:' (
	Migration) 2
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ :
,: ;
true< @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
trueH L
)L M
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ :
,: ;
true< @
)@ A
,A B
ApiKey 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P
	LoginHash 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
type5 9
:9 :
$str; A
,A B
nullableC K
:K L
trueM Q
)Q R
,R S
Discriminator !
=" #
table$ )
.) *
Column* 0
<0 1
string1 7
>7 8
(8 9
type9 =
:= >
$str? E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
ReservationHash   #
=  $ %
table  & +
.  + ,
Column  , 2
<  2 3
string  3 9
>  9 :
(  : ;
type  ; ?
:  ? @
$str  A G
,  G H
nullable  I Q
:  Q R
true  S W
)  W X
}!! 
,!! 
constraints"" 
:"" 
table"" "
=>""# %
{## 
table$$ 
.$$ 

PrimaryKey$$ $
($$$ %
$str$$% /
,$$/ 0
x$$1 2
=>$$3 5
x$$6 7
.$$7 8
Id$$8 :
)$$: ;
;$$; <
}%% 
)%% 
;%% 
migrationBuilder'' 
.'' 
CreateTable'' (
(''( )
name(( 
:(( 
$str(( 
,(( 
columns)) 
:)) 
table)) 
=>)) !
new))" %
{** 
Id++ 
=++ 
table++ 
.++ 
Column++ %
<++% &
int++& )
>++) *
(++* +
type+++ /
:++/ 0
$str++1 :
,++: ;
nullable++< D
:++D E
false++F K
)++K L
.,, 

Annotation,, #
(,,# $
$str,,$ :
,,,: ;
true,,< @
),,@ A
,,,A B
UserId-- 
=-- 
table-- "
.--" #
Column--# )
<--) *
int--* -
>--- .
(--. /
type--/ 3
:--3 4
$str--5 >
,--> ?
nullable--@ H
:--H I
true--J N
)--N O
,--O P
TripName.. 
=.. 
table.. $
...$ %
Column..% +
<..+ ,
string.., 2
>..2 3
(..3 4
type..4 8
:..8 9
$str..: @
,..@ A
nullable..B J
:..J K
true..L P
)..P Q
,..Q R
TravellerUserId// #
=//$ %
table//& +
.//+ ,
Column//, 2
<//2 3
int//3 6
>//6 7
(//7 8
type//8 <
://< =
$str//> G
,//G H
nullable//I Q
://Q R
true//S W
)//W X
}00 
,00 
constraints11 
:11 
table11 "
=>11# %
{22 
table33 
.33 

PrimaryKey33 $
(33$ %
$str33% /
,33/ 0
x331 2
=>333 5
x336 7
.337 8
Id338 :
)33: ;
;33; <
table44 
.44 

ForeignKey44 $
(44$ %
name55 
:55 
$str55 >
,55> ?
column66 
:66 
x66  !
=>66" $
x66% &
.66& '
TravellerUserId66' 6
,666 7
principalTable77 &
:77& '
$str77( /
,77/ 0
principalColumn88 '
:88' (
$str88) -
,88- .
onDelete99  
:99  !
ReferentialAction99" 3
.993 4
Restrict994 <
)99< =
;99= >
table:: 
.:: 

ForeignKey:: $
(::$ %
name;; 
:;; 
$str;; 5
,;;5 6
column<< 
:<< 
x<<  !
=><<" $
x<<% &
.<<& '
UserId<<' -
,<<- .
principalTable== &
:==& '
$str==( /
,==/ 0
principalColumn>> '
:>>' (
$str>>) -
,>>- .
onDelete??  
:??  !
ReferentialAction??" 3
.??3 4
Restrict??4 <
)??< =
;??= >
}@@ 
)@@ 
;@@ 
migrationBuilderBB 
.BB 
CreateTableBB (
(BB( )
nameCC 
:CC 
$strCC $
,CC$ %
columnsDD 
:DD 
tableDD 
=>DD !
newDD" %
{EE 
IdFF 
=FF 
tableFF 
.FF 
ColumnFF %
<FF% &
intFF& )
>FF) *
(FF* +
typeFF+ /
:FF/ 0
$strFF1 :
,FF: ;
nullableFF< D
:FFD E
falseFFF K
)FFK L
.GG 

AnnotationGG #
(GG# $
$strGG$ :
,GG: ;
trueGG< @
)GG@ A
,GGA B
PriceHH 
=HH 
tableHH !
.HH! "
ColumnHH" (
<HH( )
floatHH) .
>HH. /
(HH/ 0
typeHH0 4
:HH4 5
$strHH6 <
,HH< =
nullableHH> F
:HHF G
falseHHH M
)HHM N
,HHN O
AmountAlreadyPaidII %
=II& '
tableII( -
.II- .
ColumnII. 4
<II4 5
floatII5 :
>II: ;
(II; <
typeII< @
:II@ A
$strIIB H
,IIH I
nullableIIJ R
:IIR S
falseIIT Y
)IIY Z
,IIZ [
ObservationsJJ  
=JJ! "
tableJJ# (
.JJ( )
ColumnJJ) /
<JJ/ 0
stringJJ0 6
>JJ6 7
(JJ7 8
typeJJ8 <
:JJ< =
$strJJ> D
,JJD E
nullableJJF N
:JJN O
trueJJP T
)JJT U
,JJU V
AgencyUserIdKK  
=KK! "
tableKK# (
.KK( )
ColumnKK) /
<KK/ 0
intKK0 3
>KK3 4
(KK4 5
typeKK5 9
:KK9 :
$strKK; D
,KKD E
nullableKKF N
:KKN O
trueKKP T
)KKT U
,KKU V
DiscriminatorLL !
=LL" #
tableLL$ )
.LL) *
ColumnLL* 0
<LL0 1
stringLL1 7
>LL7 8
(LL8 9
typeLL9 =
:LL= >
$strLL? E
,LLE F
nullableLLG O
:LLO P
falseLLQ V
)LLV W
,LLW X
	StartDateMM 
=MM 
tableMM  %
.MM% &
ColumnMM& ,
<MM, -
DateTimeMM- 5
>MM5 6
(MM6 7
typeMM7 ;
:MM; <
$strMM= C
,MMC D
nullableMME M
:MMM N
trueMMO S
)MMS T
,MMT U
EndDateNN 
=NN 
tableNN #
.NN# $
ColumnNN$ *
<NN* +
DateTimeNN+ 3
>NN3 4
(NN4 5
typeNN5 9
:NN9 :
$strNN; A
,NNA B
nullableNNC K
:NNK L
trueNNM Q
)NNQ R
,NNR S
CarModelOO 
=OO 
tableOO $
.OO$ %
ColumnOO% +
<OO+ ,
stringOO, 2
>OO2 3
(OO3 4
typeOO4 8
:OO8 9
$strOO: @
,OO@ A
nullableOOB J
:OOJ K
trueOOL P
)OOP Q
,OOQ R'
CarRentalReservation_TripIdPP /
=PP0 1
tablePP2 7
.PP7 8
ColumnPP8 >
<PP> ?
intPP? B
>PPB C
(PPC D
typePPD H
:PPH I
$strPPJ S
,PPS T
nullablePPU ]
:PP] ^
truePP_ c
)PPc d
,PPd e
	HotelNameQQ 
=QQ 
tableQQ  %
.QQ% &
ColumnQQ& ,
<QQ, -
stringQQ- 3
>QQ3 4
(QQ4 5
typeQQ5 9
:QQ9 :
$strQQ; A
,QQA B
nullableQQC K
:QQK L
trueQQM Q
)QQQ R
,QQR S
AdressRR 
=RR 
tableRR "
.RR" #
ColumnRR# )
<RR) *
stringRR* 0
>RR0 1
(RR1 2
typeRR2 6
:RR6 7
$strRR8 >
,RR> ?
nullableRR@ H
:RRH I
trueRRJ N
)RRN O
,RRO P
StartingPeriodSS "
=SS# $
tableSS% *
.SS* +
ColumnSS+ 1
<SS1 2
DateTimeSS2 :
>SS: ;
(SS; <
typeSS< @
:SS@ A
$strSSB H
,SSH I
nullableSSJ R
:SSR S
trueSST X
)SSX Y
,SSY Z
EndingPeriodTT  
=TT! "
tableTT# (
.TT( )
ColumnTT) /
<TT/ 0
DateTimeTT0 8
>TT8 9
(TT9 :
typeTT: >
:TT> ?
$strTT@ F
,TTF G
nullableTTH P
:TTP Q
trueTTR V
)TTV W
,TTW X#
HotelReservation_TripIdUU +
=UU, -
tableUU. 3
.UU3 4
ColumnUU4 :
<UU: ;
intUU; >
>UU> ?
(UU? @
typeUU@ D
:UUD E
$strUUF O
,UUO P
nullableUUQ Y
:UUY Z
trueUU[ _
)UU_ `
,UU` a
TicketNumberVV  
=VV! "
tableVV# (
.VV( )
ColumnVV) /
<VV/ 0
stringVV0 6
>VV6 7
(VV7 8
typeVV8 <
:VV< =
$strVV> D
,VVD E
nullableVVF N
:VVN O
trueVVP T
)VVT U
,VVU V
FlightNumberWW  
=WW! "
tableWW# (
.WW( )
ColumnWW) /
<WW/ 0
stringWW0 6
>WW6 7
(WW7 8
typeWW8 <
:WW< =
$strWW> D
,WWD E
nullableWWF N
:WWN O
trueWWP T
)WWT U
,WWU V
DepartureDateXX !
=XX" #
tableXX$ )
.XX) *
ColumnXX* 0
<XX0 1
DateTimeXX1 9
>XX9 :
(XX: ;
typeXX; ?
:XX? @
$strXXA G
,XXG H
nullableXXI Q
:XXQ R
trueXXS W
)XXW X
,XXX Y
ArrivalDateYY 
=YY  !
tableYY" '
.YY' (
ColumnYY( .
<YY. /
DateTimeYY/ 7
>YY7 8
(YY8 9
typeYY9 =
:YY= >
$strYY? E
,YYE F
nullableYYG O
:YYO P
trueYYQ U
)YYU V
,YYV W
DepartingFromZZ !
=ZZ" #
tableZZ$ )
.ZZ) *
ColumnZZ* 0
<ZZ0 1
stringZZ1 7
>ZZ7 8
(ZZ8 9
typeZZ9 =
:ZZ= >
$strZZ? E
,ZZE F
nullableZZG O
:ZZO P
trueZZQ U
)ZZU V
,ZZV W

ArrivingAt[[ 
=[[  
table[[! &
.[[& '
Column[[' -
<[[- .
string[[. 4
>[[4 5
([[5 6
type[[6 :
:[[: ;
$str[[< B
,[[B C
nullable[[D L
:[[L M
true[[N R
)[[R S
,[[S T
TripId\\ 
=\\ 
table\\ "
.\\" #
Column\\# )
<\\) *
int\\* -
>\\- .
(\\. /
type\\/ 3
:\\3 4
$str\\5 >
,\\> ?
nullable\\@ H
:\\H I
true\\J N
)\\N O
}]] 
,]] 
constraints^^ 
:^^ 
table^^ "
=>^^# %
{__ 
table`` 
.`` 

PrimaryKey`` $
(``$ %
$str``% 6
,``6 7
x``8 9
=>``: <
x``= >
.``> ?
Id``? A
)``A B
;``B C
tableaa 
.aa 

ForeignKeyaa $
(aa$ %
namebb 
:bb 
$strbb H
,bbH I
columncc 
:cc 
xcc  !
=>cc" $
xcc% &
.cc& '
AgencyUserIdcc' 3
,cc3 4
principalTabledd &
:dd& '
$strdd( 5
,dd5 6
principalColumnee '
:ee' (
$stree) -
,ee- .
onDeleteff  
:ff  !
ReferentialActionff" 3
.ff3 4
Restrictff4 <
)ff< =
;ff= >
tablegg 
.gg 

ForeignKeygg $
(gg$ %
namehh 
:hh 
$strhh Q
,hhQ R
columnii 
:ii 
xii  !
=>ii" $
xii% &
.ii& ''
CarRentalReservation_TripIdii' B
,iiB C
principalTablejj &
:jj& '
$strjj( /
,jj/ 0
principalColumnkk '
:kk' (
$strkk) -
,kk- .
onDeletell  
:ll  !
ReferentialActionll" 3
.ll3 4
Restrictll4 <
)ll< =
;ll= >
tablemm 
.mm 

ForeignKeymm $
(mm$ %
namenn 
:nn 
$strnn M
,nnM N
columnoo 
:oo 
xoo  !
=>oo" $
xoo% &
.oo& '#
HotelReservation_TripIdoo' >
,oo> ?
principalTablepp &
:pp& '
$strpp( /
,pp/ 0
principalColumnqq '
:qq' (
$strqq) -
,qq- .
onDeleterr  
:rr  !
ReferentialActionrr" 3
.rr3 4
Restrictrr4 <
)rr< =
;rr= >
tabless 
.ss 

ForeignKeyss $
(ss$ %
namett 
:tt 
$strtt <
,tt< =
columnuu 
:uu 
xuu  !
=>uu" $
xuu% &
.uu& '
TripIduu' -
,uu- .
principalTablevv &
:vv& '
$strvv( /
,vv/ 0
principalColumnww '
:ww' (
$strww) -
,ww- .
onDeletexx  
:xx  !
ReferentialActionxx" 3
.xx3 4
Restrictxx4 <
)xx< =
;xx= >
}yy 
)yy 
;yy 
migrationBuilder{{ 
.{{ 
CreateIndex{{ (
({{( )
name|| 
:|| 
$str|| 4
,||4 5
table}} 
:}} 
$str}} %
,}}% &
column~~ 
:~~ 
$str~~ &
)~~& '
;~~' (
migrationBuilder
ÄÄ 
.
ÄÄ 
CreateIndex
ÄÄ (
(
ÄÄ( )
name
ÅÅ 
:
ÅÅ 
$str
ÅÅ C
,
ÅÅC D
table
ÇÇ 
:
ÇÇ 
$str
ÇÇ %
,
ÇÇ% &
column
ÉÉ 
:
ÉÉ 
$str
ÉÉ 5
)
ÉÉ5 6
;
ÉÉ6 7
migrationBuilder
ÖÖ 
.
ÖÖ 
CreateIndex
ÖÖ (
(
ÖÖ( )
name
ÜÜ 
:
ÜÜ 
$str
ÜÜ ?
,
ÜÜ? @
table
áá 
:
áá 
$str
áá %
,
áá% &
column
àà 
:
àà 
$str
àà 1
)
àà1 2
;
àà2 3
migrationBuilder
ää 
.
ää 
CreateIndex
ää (
(
ää( )
name
ãã 
:
ãã 
$str
ãã .
,
ãã. /
table
åå 
:
åå 
$str
åå %
,
åå% &
column
çç 
:
çç 
$str
çç  
)
çç  !
;
çç! "
migrationBuilder
èè 
.
èè 
CreateIndex
èè (
(
èè( )
name
êê 
:
êê 
$str
êê 0
,
êê0 1
table
ëë 
:
ëë 
$str
ëë 
,
ëë 
column
íí 
:
íí 
$str
íí )
)
íí) *
;
íí* +
migrationBuilder
îî 
.
îî 
CreateIndex
îî (
(
îî( )
name
ïï 
:
ïï 
$str
ïï '
,
ïï' (
table
ññ 
:
ññ 
$str
ññ 
,
ññ 
column
óó 
:
óó 
$str
óó  
)
óó  !
;
óó! "
}
òò 	
	protected
öö 
override
öö 
void
öö 
Down
öö  $
(
öö$ %
MigrationBuilder
öö% 5
migrationBuilder
öö6 F
)
ööF G
{
õõ 	
migrationBuilder
úú 
.
úú 
	DropTable
úú &
(
úú& '
name
ùù 
:
ùù 
$str
ùù $
)
ùù$ %
;
ùù% &
migrationBuilder
üü 
.
üü 
	DropTable
üü &
(
üü& '
name
†† 
:
†† 
$str
†† #
)
††# $
;
††$ %
migrationBuilder
¢¢ 
.
¢¢ 
	DropTable
¢¢ &
(
¢¢& '
name
££ 
:
££ 
$str
££ 
)
££ 
;
££ 
migrationBuilder
•• 
.
•• 
	DropTable
•• &
(
••& '
name
¶¶ 
:
¶¶ 
$str
¶¶ 
)
¶¶ 
;
¶¶ 
}
ßß 	
}
®® 
}©© ù
MC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\AgencyUser.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public 

class 

AgencyUser 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
String 
Name 
{ 
get  
;  !
set" %
;% &
}' (
List 
< 
Reservation 
> 
Reservations &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

AgencyUser 
( 
) 
{ 	
Reservations 
= 
new 
List #
<# $
Reservation$ /
>/ 0
(0 1
)1 2
;2 3
} 	
} 
} ﬁ
WC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\CarRentalReservation.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public		 

class		  
CarRentalReservation		 %
:		% &
Reservation		' 2
{

 
public 
DateTime 
	StartDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
EndDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
String 
CarModel 
{  
get! $
;$ %
set& )
;) *
}+ ,
public  
CarRentalReservation #
(# $
)$ %
:& '
base( ,
(, -
)- .
{/ 0
}1 2
} 
} ì

YC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\Hashing\PasswordHasher.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
. 
Hashing &
{ 
public 

class 
PasswordHasher 
{		 
public

 
static

 
String

 
getHash

 $
(

$ %
String

% +
fromStr

, 3
)

3 4
{ 	
String 
	loginHash 
= 
BCrypt %
.% &
Net& )
.) *
BCrypt* 0
.0 1
HashPassword1 =
(= >
fromStr> E
)E F
;F G
return 
	loginHash 
; 
} 	
public 
static 
bool 
	checkHash $
($ %
String% +
hash1, 1
,1 2
String3 9
hash2: ?
)? @
{ 	
return 
BCrypt 
. 
Net 
. 
BCrypt $
.$ %
Verify% +
(+ ,
hash1, 1
,1 2
hash23 8
)8 9
;9 :
} 	
} 
} ˜
SC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\HotelReservation.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public		 

class		 
HotelReservation		 !
:		! "
Reservation		# .
{

 
public 
String 
	HotelName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
String 
Adress 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
StartingPeriod &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DateTime 
EndingPeriod $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
HotelReservation 
(  
)  !
:" #
base$ (
(( )
)) *
{+ ,
}, -
} 
} œ
YC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\PlaneTicketReservation.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public		 

class		 "
PlaneTicketReservation		 '
:		' (
Reservation		) 4
{

 
public 
String 
TicketNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
String 
FlightNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
DepartureDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
ArrivalDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
String 
DepartingFrom #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
String 

ArrivingAt  
{! "
get# &
;& '
set( +
;+ ,
}- .
public "
PlaneTicketReservation %
(% &
)& '
:' (
base) -
(- .
). /
{0 1
}2 3
} 
} ì
aC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\RequestWrappers\AddTripRequest.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
. 
RequestWrappers .
{ 
public 

class 
AddTripRequest 
{		 
public

 
String

 
TripName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
String 
ApiKey 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ˘
_C:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\RequestWrappers\LoginRequest.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
. 
RequestWrappers .
{ 
public		 

class		 
LoginRequest		 
{

 
[ 	
Required	 
] 
public 
String 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
String 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ‘
bC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\RequestWrappers\RegisterRequest.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
. 
RequestWrappers .
{ 
public		 

class		 
RegisterRequest		  
{

 
[ 	
Required	 
] 
public 
String 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
String 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
String 
PasswordCheck #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} Ç	
NC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\Reservation.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public 

class 
Reservation 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
Trip 
Trip 
; 
public 
float 
Price 
{ 
get  
;  !
set" %
;% &
}' (
public 
float 
AmountAlreadyPaid &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
String 
Observations "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

AgencyUser 
? 

AgencyUser %
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} îN
XC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\ReservationsDbContext.cs
	namespace		 	
TheRoadWarrior		
 
.		 
Model		 
{

 
public 

class !
ReservationsDbContext &
:& '
	DbContext( 1
{ 
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 

AgencyUser 
>  
AgencyUsers! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
DbSet 
< 
TravellerUser "
>" #
TravellerUsers$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
DbSet 
<  
CarRentalReservation )
>) *!
CarRentalReservations+ @
{A B
getC F
;F G
setH K
;K L
}M N
public 
DbSet 
< 
HotelReservation %
>% &
HotelReservations' 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
DbSet 
< "
PlaneTicketReservation +
>+ ,#
PlaneTicketReservations- D
{E F
getG J
;J K
setL O
;O P
}Q R
public 
DbSet 
< 
Reservation  
>  !
Reservations" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Trip 
> 
Trips  
{! "
get# &
;& '
set( +
;+ ,
}- .
public !
ReservationsDbContext $
($ %
[% &
NotNullAttribute& 6
]6 7
DbContextOptions8 H
optionsI P
)P Q
:R S
baseT X
(X Y
optionsY `
)` a
{ 	
Database 
. 
EnsureCreated "
(" #
)# $
;$ %
} 	
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. 
	UseSqlite $
($ %
$str% C
)C D
;D E
} 	
public 
TravellerUser 
GetUser $
($ %
String% +
username, 4
)4 5
{   	
TravellerUser!! 
usr!! 
=!! 
TravellerUsers!!  .
.!!. /
ToList!!/ 5
(!!5 6
)!!6 7
.!!7 8
Find!!8 <
(!!< =
usr!!= @
=>!!A C
usr!!D G
.!!G H
UserName!!H P
==!!Q S
username!!T \
)!!\ ]
;!!] ^
if"" 
("" 
usr"" 
=="" 
null"" 
)"" 
{## 
throw$$ %
InvalidOperationException$$ /
($$/ 0
$str$$0 E
)$$E F
;$$F G
}%% 
return&& 
usr&& 
;&& 
}'' 	
public(( 
TravellerUser(( 
GetUserByApiKey(( ,
(((, -
String((- 3
apiKey((4 :
)((: ;
{)) 	
TravellerUser** 
usr** 
=** 
TravellerUsers**  .
.**. /
ToList**/ 5
(**5 6
)**6 7
.**7 8
Find**8 <
(**< =
usr**= @
=>**A C
PasswordHasher**D R
.**R S
	checkHash**S \
(**\ ]
usr**] `
.**` a
ApiKey**a g
,**g h
apiKey**i o
)**o p
)**p q
;**q r
if++ 
(++ 
usr++ 
==++ 
null++ 
)++ 
{,, 
throw-- %
InvalidOperationException-- /
(--/ 0
$str--0 E
)--E F
;--F G
}.. 
return// 
usr// 
;// 
}00 	
public11 
void11 
CreateTravellerUser11 '
(11' (
String11( .
apiKey11/ 5
,115 6
String117 =
	loginHash11> G
,11G H
String11I O
username11P X
)11X Y
{22 	
if33 
(33 
TravellerUsers33 
.33 
ToList33 $
(33$ %
)33% &
.33& '
Find33' +
(33+ ,
usr33, /
=>330 2
usr333 6
.336 7
UserName337 ?
==33@ B
username33C K
)33K L
!=33M O
null33P T
)33T U
{44 
throw55 %
InvalidOperationException55 /
(55/ 0
$str550 C
)55C D
;55D E
}66 
TravellerUser77 
usr77 
=77 
new77  #
(77# $
)77$ %
{88 
	LoginHash99 
=99 
	loginHash99 %
,99% &
ApiKey:: 
=:: 
apiKey:: 
,::  
UserName;; 
=;; 
username;; #
,;;# $
Trips<< 
=<< 
new<< 
List<<  
<<<  !
Trip<<! %
><<% &
(<<& '
)<<' (
}== 
;== 
TravellerUsers>> 
.>> 
Add>> 
(>> 
usr>> "
)>>" #
;>># $
this?? 
.?? 
SaveChanges?? 
(?? 
)?? 
;?? 
}@@ 	
privateBB 
	ExceptionBB %
InvalidOperationExceptionBB 3
(BB3 4
stringBB4 :
vBB; <
)BB< =
{CC 	
throwDD 
newDD #
NotImplementedExceptionDD -
(DD- .
)DD. /
;DD/ 0
}EE 	
publicGG 
voidGG 

CreateTripGG 
(GG 
intGG "
	forUserIdGG# ,
,GG, -
StringGG. 4
tripNameGG5 =
)GG= >
{HH 	
TripII 
tripII 
=II 
newII 
(II 
)II 
{JJ 
TripNameKK 
=KK 
tripNameKK #
,KK# $
HotelReservationsLL !
=LL" #
newLL$ '
ListLL( ,
<LL, -
HotelReservationLL- =
>LL= >
(LL> ?
)LL? @
,LL@ A!
CarRentalReservationsMM %
=MM& '
newMM( +
ListMM, 0
<MM0 1 
CarRentalReservationMM1 E
>MME F
(MMF G
)MMG H
,MMH I#
PlaneTicketReservationsNN '
=NN( )
newNN* -
ListNN. 2
<NN2 3"
PlaneTicketReservationNN3 I
>NNI J
(NNJ K
)NNK L
,NNL M
}OO 
;OO 
TravellerUserPP 
usrPP 
=PP 
TravellerUsersPP  .
.PP. /
ToListPP/ 5
(PP5 6
)PP6 7
.PP7 8
FindPP8 <
(PP< =
usrPP= @
=>PPA C
usrPPD G
.PPG H
IdPPH J
==PPK M
	forUserIdPPN W
)PPW X
;PPX Y
usrQQ 
.QQ 
TripsQQ 
.QQ 
AddQQ 
(QQ 
tripQQ 
)QQ 
;QQ  
thisRR 
.RR 
SaveChangesRR 
(RR 
)RR 
;RR 
}SS 	
publicUU 
voidUU %
AddHotelReservationToTripUU -
(UU- .
intVV 
	forTripIdVV 
,VV 
StringWW 
	hotelNameWW 
,WW 
DateTimeXX 
	startDateXX 
,XX 
DateTimeYY 
endDateYY 
,YY 
StringZZ 
adressZZ 
,ZZ 
float[[ 
price[[ 
,[[ 
float\\ 
amountAlreadyPaid\\ #
,\\# $

AgencyUser]] 

agencyUser]] !
=]]" #
null]]$ (
,]]( )
String^^ 
observations^^ 
=^^  !
$str^^" $
)^^$ %
{__ 	
HotelReservation`` 
hrs``  
=``! "
new``# &
(``& '
)``' (
{aa 
Pricebb 
=bb 
pricebb 
,bb 
AmountAlreadyPaidcc !
=cc" #
amountAlreadyPaidcc$ 5
,cc5 6
Observationsdd 
=dd 
observationsdd +
,dd+ ,

AgencyUseree 
=ee 

agencyUseree '
,ee' (
StartingPeriodff 
=ff  
	startDateff! *
,ff* +
EndingPeriodgg 
=gg 
endDategg &
,gg& '
Adresshh 
=hh 
adresshh 
,hh  
	HotelNameii 
=ii 
	hotelNameii %
}jj 
;jj 
varkk 
tripkk 
=kk 
Tripskk 
.kk 
ToListkk #
(kk# $
)kk$ %
.kk% &
Findkk& *
(kk* +
trkk+ -
=>kk. 0
trkk1 3
.kk3 4
Idkk4 6
==kk7 9
	forTripIdkk: C
)kkC D
;kkD E
tripll 
.ll 
HotelReservationsll "
.ll" #
Addll# &
(ll& '
hrsll' *
)ll* +
;ll+ ,
}mm 	
}oo 
}pp ù
cC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\ResponseWrappers\AddTripResponse.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
. 
ResponseWrappers /
{ 
public 

class 
AddTripResponse  
{		 
public

 
int

 
ResponseCode

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
String 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} î
hC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\ResponseWrappers\LoginResponseWrapper.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public		 

class		  
LoginResponseWrapper		 %
{

 
public 
int 
ResponseCode 
{  !
get" %
;% &
set' *
;* +
}, -
public 
String 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
String 
ApiKey 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ˙	
PC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\TravellerUser.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public		 

class		 
TravellerUser		 
:		  
User		! %
{

 
[ 	
Required	 
] 
public 
String 
ReservationHash %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
Required	 
] 
public 
List 
< 
Trip 
> 
Trips 
{  !
get" %
;% &
set' *
;* +
}, -
public 
TravellerUser 
( 
) 
: 
base  $
($ %
)% &
{' (
Trips 
= 
new 
List 
< 
Trip !
>! "
(" #
)# $
;$ %
} 	
public 
String 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ß
GC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\Trip.cs
	namespace 	
TheRoadWarrior
 
. 
Model 
{ 
public 

class 
Trip 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
public 
List 
<  
CarRentalReservation (
>( )!
CarRentalReservations* ?
{@ A
getB E
;E F
setG J
;J K
}L M
public 
List 
< 
HotelReservation $
>$ %
HotelReservations& 7
{8 9
get: =
;= >
set? B
;B C
}D E
public 
List 
< "
PlaneTicketReservation *
>* +#
PlaneTicketReservations, C
{D E
getF I
;I J
setK N
;N O
}P Q
public 
String 
TripName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
Trip 
( 
) 
{ 	!
CarRentalReservations !
=" #
new$ '
List( ,
<, - 
CarRentalReservation- A
>A B
(B C
)C D
;D E
HotelReservations 
= 
new  #
List$ (
<( )
HotelReservation) 9
>9 :
(: ;
); <
;< =#
PlaneTicketReservations #
=$ %
new& )
List* .
<. /"
PlaneTicketReservation/ E
>E F
(F G
)G H
;H I
} 	
} 
} µ
GC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Model\User.cs
	namespace 	
TheRoadWarrior
 
{ 
public		 

class		 
User		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
String 
ApiKey 
{ 
get "
;" #
set$ '
;' (
}) *
public 
String 
	LoginHash 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} †

DC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Program.cs
	namespace

 	
TheRoadWarrior


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ë
DC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\Startup.cs
	namespace 	
TheRoadWarrior
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddControllers #
(# $
)$ %
;% &
services 
. 
AddSwaggerGen "
(" #
)# $
;$ %
services   
.   
AddDbContext   !
<  ! "!
ReservationsDbContext  " 7
>  7 8
(  8 9
options  9 @
=>  A C
{  D E
options!! 
.!! 
	UseSqlite!! !
(!!! "
this!!" &
.!!& '
Configuration!!' 4
.!!4 5
GetConnectionString!!5 H
(!!H I
$str!!I \
)!!\ ]
)!!] ^
;!!^ _
}"" 
)"" 
;"" 
}## 	
public&& 
void&& 
	Configure&& 
(&& 
IApplicationBuilder&& 1
app&&2 5
,&&5 6
IWebHostEnvironment&&7 J
env&&K N
)&&N O
{'' 	
if(( 
((( 
env(( 
.(( 
IsDevelopment(( !
(((! "
)((" #
)((# $
{)) 
app** 
.** %
UseDeveloperExceptionPage** -
(**- .
)**. /
;**/ 0
}++ 
app-- 
.-- 

UseSwagger-- 
(-- 
)-- 
;-- 
app// 
.// 
UseSwaggerUI// 
(// 
c// 
=>// !
{00 
c11 
.11 
SwaggerEndpoint11 !
(11! "
$str11" <
,11< =
$str11> Q
)11Q R
;11R S
}22 
)22 
;22 
app44 
.44 
UseHttpsRedirection44 #
(44# $
)44$ %
;44% &
app66 
.66 

UseRouting66 
(66 
)66 
;66 
app88 
.88 
UseAuthorization88  
(88  !
)88! "
;88" #
app:: 
.:: 
UseEndpoints:: 
(:: 
	endpoints:: &
=>::' )
{;; 
	endpoints<< 
.<< 
MapControllerRoute<< ,
(<<, -
name== 
:== 
$str== #
,==# $
pattern>> 
:>> 
$str>> E
)>>E F
;>>F G
}?? 
)?? 
;?? 
}@@ 	
}AA 
}BB ‘
LC:\UAIC\.NET\TheRoadWarrior\TheRoadWarrior\TheRoadWarrior\WeatherForecast.cs
	namespace 	
TheRoadWarrior
 
{ 
public 

class 
WeatherForecast  
{ 
public 
DateTime 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
int		 
TemperatureC		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public 
int 
TemperatureF 
=>  "
$num# %
+& '
(( )
int) ,
), -
(- .
TemperatureC. :
/; <
$num= C
)C D
;D E
public 
string 
Summary 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} 